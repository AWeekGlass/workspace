package com.hengyu.user.service.impl;

import java.util.List;
import java.util.Objects;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.baomidou.mybatisplus.mapper.EntityWrapper;
import com.baomidou.mybatisplus.service.impl.ServiceImpl;
import com.hengyu.user.dao.RolePermissionDAO;
import com.hengyu.user.entity.RolePermission;
import com.hengyu.user.service.RolePermissionService;
import com.hengyu.user.vo.PermissionVo;

/**
 * <p>
 * 服务实现类
 * </p>
 *
 * @author allnas
 * @since 2018-08-22
 */
@Service
public class RolePermissionServiceImpl extends ServiceImpl<RolePermissionDAO, RolePermission>
		implements RolePermissionService {
	@Autowired
	private RolePermissionDAO rolePermissionDAO;

	@Override
	public PermissionVo queryPermissionByRoleId(Integer roleId) {
		PermissionVo permission = new PermissionVo();
		permission.setCategoryList(rolePermissionDAO.queryCategoryByRoleId(roleId));
		permission.setRolePermissionList(rolePermissionDAO.queryResourceByRoleId(roleId));
		return permission;
	}

	@Override
	public Boolean updateByRoleId(Integer roleId, List<RolePermission> rolePermissions) {
		if(Objects.isNull(rolePermissions) || rolePermissions.isEmpty()){
			return false;
		}
		rolePermissionDAO.delete(new EntityWrapper<RolePermission>().eq("role_id", roleId));
		return insertBatch(rolePermissions);
	}

	@Override
	public Boolean addByRoleId(List<RolePermission> rolePermissions) {
		return insertBatch(rolePermissions);
	}
}